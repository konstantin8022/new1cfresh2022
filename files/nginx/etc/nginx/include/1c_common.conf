# Таймаут для установления соединения с проксированным сервером
proxy_connect_timeout 5s;

# Таймаут при чтении ответа проксированного сервера
proxy_read_timeout    300s;

# Дополнительные заголовки запроса, передаваемые
#   проксируемому серверу
proxy_set_header Host              $host;
proxy_set_header X-Real-IP         $remote_addr;
proxy_set_header X-Forwarded-For   $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto https;

# Условия передачи запроса следующему веб-серверу (если
#    веб-сервер неработоспособен, или при обращении к нему
#    произошел таймаут, или получен ответ с HTTP-кодом 502
#    (причем перенаправление выполняется и для POST-запросов)
proxy_next_upstream error timeout http_502 non_idempotent;
